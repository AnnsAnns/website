<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="tomGER"><meta name=description content="Interesting stories about programming languages, libraries, tools and much more."><meta name=generator content="Hugo 0.71.1"><title>Short: How to cross-compile Rust from WSL Linux to Windows &#183; tomGER's Blog</title><link rel="shortcut icon" href=https://tomger.eu/images/favicon.ico><link rel=stylesheet href=https://tomger.eu/css/spectre.min.css async defer><link rel=stylesheet href=https://tomger.eu/css/style.css async defer><link rel=stylesheet href=https://tomger.eu/css/highlight.css async defer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css defer><meta property="og:title" content="Short: How to cross-compile Rust from WSL Linux to Windows"><meta property="og:description" content="A small blog post showcasing easy ways to cross-compile Rust from WSL Linux (Arch) to Windows"><meta property="og:type" content="article"><meta property="og:url" content="https://tomger.eu/posts/cross-compile-rust-wsl/"><meta property="og:image" content="https://tomger.eu/logo.png"><meta property="article:published_time" content="2021-02-25T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-25T00:00:00+00:00"><meta itemprop=name content="Short: How to cross-compile Rust from WSL Linux to Windows"><meta itemprop=description content="A small blog post showcasing easy ways to cross-compile Rust from WSL Linux (Arch) to Windows"><meta itemprop=datePublished content="2021-02-25T00:00:00+00:00"><meta itemprop=dateModified content="2021-02-25T00:00:00+00:00"><meta itemprop=wordCount content="827"><meta itemprop=image content="https://tomger.eu/logo.png"><meta itemprop=keywords content="rust,short,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tomger.eu/logo.png"><meta name=twitter:title content="Short: How to cross-compile Rust from WSL Linux to Windows"><meta name=twitter:description content="A small blog post showcasing easy ways to cross-compile Rust from WSL Linux (Arch) to Windows"><meta name=twitter:site content="@https://www.twitter.com/_tomGER"></head><body><div class="container p-fixed" style=z-index:3><nav class="navbar m-2 p-2 s-rounded shadow bg-primary"><section class=navbar-section><button class="btn btn-action btn-primary pixel" aria-label="Change Colour" id=pixelfont-toggle><i class="fas fa-lightbulb fa-lg"></i></button>
<a class="btn btn-primary pixel mx-2" href=https://tomger.eu/>Home</a></section><section class="navbar-section pixel"><a class="btn btn-primary" href=https://ko-fi.com/tomGER>Donate (Ko-Fi)</a>
<a class="btn btn-primary mx-2" aria-label=About href=/about/>About</a></section></nav></div><section class="container grid-md"><div class=columns><article class="container p-centered mt-space"><header><h2 class=text-center>Short: How to cross-compile Rust from WSL Linux to Windows</h2><h6 class="text-gray text-italic text-center">A small blog post showcasing easy ways to cross-compile Rust from WSL Linux (Arch) to Windows</h6></header><section class=my-gap><figure class=text-center><img src=logo.png alt=ðŸ¦€ðŸ¦€ðŸ¦€ width=50% height=50%></figure><p>Okay, look, I have fallen down the rabbit hole when it comes to Rust. At first I didn&rsquo;t expect to use the language to a great extend but the more I use it, the more I like it. Besides the great compiler and all the other benefits Rust comes with, the tooling is also amazing. There are so many useful community and first-party tools for many boilerplate problems that keep you from working efficiently, from easy wasm support to embedded software.</p><p>In this (hopefully) short blogpost in the &ldquo;Heck, I wish I knew this earlier&rdquo; series, I want to showcase some really easy ways to cross-compile Rust projects to different architectures.</p><h3 id=wsl>WSL</h3><p>WSL is extremely useful and Microsoft is doing one great job when it comes to their <a href=https://en.wikipedia.org/wiki/Embrace,_extend,_and_extinguish>&ldquo;Embrace, extend, and extinguish&rdquo;</a> tactic. I love the fact that I can do all my work on the far greater platform for developers (Linux) while still running the buggy mess that is Windows 10 for all the software that doesn&rsquo;t really work well on Linux.</p><figure class=text-center><img src=neofetch.png alt="Neofetch showing that I run Arch" width=70% height=70%></figure><p>And as some readers might already know, &ldquo;btw I use Arch&rdquo;. Which means that even my WSL distribution is Arch, thanks to <a href=https://github.com/yuk7/ArchWSL>the awesome community of Arch</a>.</p><p>While WSL 1 was quite mediocre, WSL 2 offers the full Linux experience, allowing me to do everything from desktop environments through server hosting. Sadly, WSL2 still only support software rendering, which is a major bottleneck for all applications that do more than a simple GUI, and even then, some GUIs don&rsquo;t even support software rendering.</p><p>Microsoft is even working on a solution to this, but it honestly looks quite questionable and is still not live so we couldn&rsquo;t even use it if we wanted to. There is a solution to this however, just cross-compile whatever you need to Windows and run it on Windows and there is a myriad of ways to do that. In this blog post I&rsquo;ll just quickly talk about 3 solutions that I went through with the most important one being <a href=https://github.com/rust-embedded/cross>&ldquo;Cross&rdquo;</a> for rust.</p><h3 id=lvl-5-crook-just-compile-on-windows>Lvl. 5, Crook: Just compile <em>on Windows</em></h3><p>I also like to call this the <em>&ldquo;You want to suffer&rdquo;</em> method. Even though this method has the most documentation, it kinda defeats the point. Why would you need a WSL instance when using the inferior Windows toolchain.</p><p>Anyways, the setup is basically just three <em>&ldquo;simple&rdquo;</em> steps.</p><ol><li>Install half a terrabyte of Microsoft toolchains + Microsoft Visual Studio from here: <a href=https://visualstudio.microsoft.com/visual-cpp-build-tools/>https://visualstudio.microsoft.com/visual-cpp-build-tools/</a><ul><li>To be more exact, you only need the &ldquo;Visual Studio C++ Build tools&rdquo; but naturally, you can&rsquo;t simply type &ldquo;pacman -S&rdquo; like on Arch.</li></ul></li><li>Install <a href=https://www.rust-lang.org/tools/install>Rustup</a><ul><li>As to be expected, Rust makes everything really really easy for you :)</li></ul></li><li>Regret your life choices because you decided to use Windows as your programming environment</li></ol><h3 id=lvl-50-boss-use-mingw64-to-compile-from-linux-to-windows>Lvl. 50, Boss: Use Mingw64 to compile from Linux to Windows</h3><p>Honestly, people have made way better tutorials for Mingw64 Linux and I don&rsquo;t feel like investing the time into explaining something I don&rsquo;t even recommend.</p><p>If you actually want to use Mingw64 instead of using Cross, follow the Arch Wiki: <a href=https://wiki.archlinux.org/index.php/Rust#Windows>https://wiki.archlinux.org/index.php/Rust#Windows</a></p><h3 id=lvl-100-hackerman-use-crosshttpsgithubcomrust-embeddedcross>Lvl. 100, Hackerman: Use <a href=https://github.com/rust-embedded/cross>Cross</a></h3><p>My god, I wish I knew this existed earlier. <a href=https://github.com/rust-embedded/cross>Cross</a> is a project by the <a href=https://github.com/rust-embedded/wg#the-tools-team>Rust Embedded Tooling Team</a> which makes cross-compiling of Rust absolutely painless. I have never had an easier time cross-compiling anything, it&rsquo;s literally a single line of work and absolutely astonishing work by the Rust Embedded Tooling Team.</p><h5 id=setup-on-linux>Setup on Linux:</h5><ol><li>Have a working version of Rustup<ul><li><code>pacman -S rustup</code></li></ul></li><li>Install either Docker or Podman<ul><li><code>pacman -S podman</code></li></ul></li><li>Lastly, install cross<ul><li><code>cargo install cross</code></li></ul></li></ol><h5 id=setup-on-wsl>Setup on WSL:</h5><ol><li>Have a working version of Rustup<ul><li><code>pacman -S rustup</code></li></ul></li><li>Ensure that you installed <a href=https://www.docker.com/get-started>Docker <strong>on Windows</strong></a><ul><li>Docker on Windows utilizes WSL2 and hijacks all docker calls, so you can&rsquo;t simple install Docker from within Arch afaik</li></ul></li><li>Ensure that Docker for Windows lists your WSL2 instance in Settings>Resources>WSL Integration</li><li>Lastly, install cross<ul><li><code>cargo install cross</code></li></ul></li></ol><p>After this, you can simple use Cross to compile to your specified target. In our case we want to compile to x86_64 Windows, which means simple typing <code>cross build --target x86_64-pc-windows-gnu</code>. After that, you should have <code>&lt;project_name>.exe</code> in <code>target\x86_64-pc-windows-gnu\debug</code>.</p><p>WSL even allows you to simple call the exe from your Subsystem&rsquo;s shell, in which case it will execute it natively from Windows. Success, you just cross-compiled to Windows from a Linux WSL instance in a single command.</p><h3 id=conclusion>Conclusion</h3><p>Rust is awesome, praise Rust.</p><p>In all seriousness though, such excellent tooling is beyond expectable for a language that is still so young and new. I hope I managed to keep this blog post relatively short and thank you for taking the time out of your day just to read it.</p><p>If you have any questions (or want to follow me on social media), feel free to visit my <a href=https://www.twitter.com/_tomGER>Twitter</a>.</p><p>I also made some major changes to my blog, majorly increasing speed, SEO, accessibility and more. If you noticed anything breaking, I&rsquo;d be happy to fix it.</p><code class=text-bold>Tags</code>
<a class="chip text-accent" href=https://tomger.eu/%20tags/rust%20>rust</a>
<a class="chip text-accent" href=https://tomger.eu/%20tags/short%20>short</a></section><div class="divider my-gap"></div><footer class="col-12 d-inline-block"><span class=float-left><button class="btn btn-action btn-accent shadow s-circle" aria-label=Return onclick=window.history.back();><i class="fas fa-arrow-left"></i></button></span>
<span class=float-right><div class="text-right float-left mx-2"><span class=text-dark>tomGER</span><br><span class=text-gray>Procrastinator</span></div><figure class="avatar avatar-lg"><img id=profile alt></figure><div class=container><a class=symbol href=mailto:blog@tomger.eu target=_blank><i class="fas fa-envelope"></i></a><a class=symbol href=https://www.github.com/tumger aria-label=https://www.github.com/tumger target=_blank rel=noreferrer><i class="fab fa-github"></i></a><a class=symbol href=https://www.twitter.com/_tomGER aria-label=https://www.twitter.com/_tomGER target=_blank rel=noreferrer><i class="fab fa-twitter"></i></a></div></span></footer></article><footer class="container p-centered text-center my-gap"><small class=text-gray>Â© Copyright 2021 tomGER<br>Based on spectre-pixel by st-wong</small></footer></div></section><script src=//ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js async defer></script><script src=https://tomger.eu/js/main.js async defer></script><script src=https://tomger.eu/js/highlight.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>